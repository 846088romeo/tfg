(* Protocol: AndrewSecureRPC *)

(* Declarations *)
B know B
B know A
B know succ
B know shk(<A,B>)
A know A
A know B
A know succ
A know tag
A know shk(<A,B>)
private ShkAB     (* A,B share shk(<A,B>) *)
A generates NA
B generates NB
B generates NB2

(* Actions *)
A -> B : <A,encS(<tag,NA>,shk(<A,B>))>
B -> A : encS(<succ(NA),NB>,shk(<A,B>))
A -> B : encS(succ(NB),shk(<A,B>))
B -> A : encS(NB2,shk(<A,B>))
