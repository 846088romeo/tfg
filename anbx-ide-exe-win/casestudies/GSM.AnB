Protocol: GSM

Types:
	Agent H,M,B;
	Number NB,Msg;
	Function ki;		# Agent,Agent ->* Number
	Function kc;		# Number,Number -> SymmetricKey
	Function hash;		# Untyped -> Number

Knowledge:
	M: M,B,H,kc,hash,ki(M,H);
	B: B,M,hash;
	H: B,H,M,kc,hash,ki(M,H)

Actions:
	H -> B: NB,hash(NB,ki(M,H)),kc(NB,ki(M,H))
	B -> M: NB
	M -> B: hash(NB,ki(M,H))
	B -> M: {|Msg|}kc(NB,ki(M,H))

Goals:
	B authenticates M on NB
	Msg secret between B,M
